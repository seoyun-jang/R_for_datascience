---
title: "3.3 Arrange rows with arrage()"
author: "seo yun Jang"
date: '2022 2 9 '
output: html_document
---
```{r, warning=FALSE}
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)

flights <- nycflights13::flights
```

## 3.3 arrange()로 행 정렬하기

arrange()는 행을 선택하는 대신, *순서를 바꾼다*는 것만 제외하고는 filter()와 유사하게 작동한다. 데이터프레임과 정렬기준으로 지정한 열 이름집합(혹은 목잡한 표현식)을 입력으로 한다. 하나 이상의 열 이름을 제공하면 각 열은 이전 열의 동점값(tie)상황을 해결하는 데 사용된다.

```{r}
# year, month, day 순으로 먼저 정렬하기
(arrange(flights, year, month, day))

# desc()를 사용하여 내림차순으로 재정렬
(arrange(flights, desc(arr_delay)))

# 결측값은 항상 마지막에 정렬된다.
df <- tibble(x = c(5, 2, 8, 3, NA))
arrange(df, x)
arrange(df, desc(x))
```
### 연습문제
1. `arrange()`를 사용하여 모든 결측값을 앞에 오도록 정렬하라
```{r}
arrange(flights, desc(is.na(dep_time)), dep_time) %>% select(dep_time)
```

2. flights를 정렬하여 가장 지연된 항공편을 찾아라. 가장 일찍 출발한 항공편을 찾아라
```{r}
# 가장 지연된 항공편 (출발 지연시간,  예정된 출발시간, 실제 출발시간)
(arrange(flights, desc(dep_delay)))[1,] %>% select(dep_delay, sched_dep_time, dep_time)

# 가장 일찍 출발한 항공편 (출발 지연시간,  예정된 출발시간, 실제 출발시간)
(arrange(flights, dep_delay))[1,] %>% select(dep_delay, sched_dep_time, dep_time)

```

3. flights를 정렬하여 가장 빠른 항공편을 찾아라
- "가장 빠른 항공편"이란 말은 "가장 짧은 비행시간을 가진 항공편"이라는 말로 해석할 수 있다. 따라서 air_time 변수에 따라 정렬하여 나타낼 수 있다.
```{r}
(arrange(flights, air_time))[1,] %>% select(air_time, carrier, tailnum)
```
- 또 다른 해석은 "속도"가 가장 빠른 항공편을 의미할 수 있다. 이는 거리(distance) / 시간(air_time)으로 계산할 수 있다.
```{r}
(arrange(flights, desc(distance / air_time))) %>% select(carrier, tailnum, distance,air_time)
```


4. 어떤 항공편이 가장 멀리 운항했는가? 가장 짧게 운항한 항공편은?
```{r}
# 가장 멀리 운항한 항공편
(arrange(flights, desc(distance)))[1,] %>% select(distance, origin, dest)

# 가장 짧게 운항한 항공편
(arrange(flights, distance))[1,] %>% select(distance, origin, dest)
```

